<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style type="text/css">
		*{
			margin: 0;
			padding: 0;
			list-style: none;
		}
		.wrap{
			width: 100%;
		}
		.item{			
			margin:0px 10px 20px;
      width:800px;
      height:20px;
      margin:0 auto;
		}
	</style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script>function sendData() {
        google.script.run.withSuccessHandler(
          function(data){
            if (data.includes("查無資料")){
              data = data.toUpperCase();
              document.getElementById("search_result").innerHTML = data;
              document.getElementById("barcode_svg").innerHTML = "";              
              this.clean();
            }else{              
              JsBarcode("#barcode_svg", data[3] + "0019999999", {width:4, fontSize:30});
              document.getElementById("product_code_title").innerHTML = "1、藥品編號：";
              document.getElementById("drug_code_title").innerHTML = "2、料位號：";
              document.getElementById("drug_name_title").innerHTML = "3、藥品名稱：";
              document.getElementById("first_brand_name_title").innerHTML = "4、第一商品名：";
              document.getElementById("secend_brand_name_title").innerHTML = "5、第二商品名：";

              document.getElementById("product_code").innerHTML = data[0];
              document.getElementById("drug_code").innerHTML = data[3];
              document.getElementById("drug_name").innerHTML = data[1];
              document.getElementById("first_brand_name").innerHTML = data[2];
              document.getElementById("secend_brand_name").innerHTML = data[4];
              
              this.clean();              
            }
          }
        ).searchSheet(document.getElementById("input_user").value.trim());
      };      
    </script>
  
  <script>function clean() {
        document.getElementById("input_user").value = "";
      };      
    </script>
  
  <script>function barcodeGenerate(){
        strBarcode = document.getElementById("input_user").value.trim();
      if (strBarcode.length < 1){
        document.getElementById("search_result").innerHTML = "請輸入資訊。";
        document.getElementById("barcode_svg").innerHTML = "";
        this.clean();
      }else{
        JsBarcode("#barcode_svg", strBarcode.toUpperCase() + "0019999999", {width:4, fontSize:30});
        document.getElementById("search_result").innerHTML = "";
        this.clean();        
      }        
  };
    </script>

  </head>
  <body>
    <div class="wrap">
	<div class="item">
        <br>
		<h1 style="font-size: 50px">品項名查詢</h1>
      <br>
        <h1>請輸入料位號：</h1><input id="input_user" type="text" style="font-size: 50px; width: 200px" name="userName">
      <br><br><br>
        <button type="submit" style="font-size: 50px;" onclick="sendData()">送出</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="submit" style="font-size: 50px;" onclick="barcodeGenerate()">產生Barcode</button>       
      <br><br><br>
        <button type="reset" style="font-size: 50px;" onclick="clean()">清除</button>
      <br>
    
    <svg id="barcode_svg"></svg>
    <h1 id="search_result" style="font-size: 4em; color: #006400;"></h1>

    <h1 id="product_code_title"></h1><h1 id="product_code" style="font-size: 4em; color: #006400;"></h1><br><br>
    <h1 id="drug_code_title"></h1><h1 id="drug_code" style="font-size: 4em; color: #006400;"></h1><br><br>
    <h1 id="drug_name_title"></h1><h1 id="drug_name" style="font-size: 4em; color: #006400;"></h1><br><br>
    <h1 id="first_brand_name_title"></h1><h1 id="first_brand_name" style="font-size: 4em; color: #006400;"></h1><br><br>
    <h1 id="secend_brand_name_title"></h1><h1 id="secend_brand_name" style="font-size: 4em; color: #006400;"></h1><br><br>
    <br><br><br>
    <h4>問題聯繫：vincent 燊<h4>
	</div>  
</div>
  </body>
</html>
