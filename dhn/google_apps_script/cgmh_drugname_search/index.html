<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style type="text/css">
    button{
      color: white;
      font-size: 80px;
    }
    h1{
      color: white;
    }
		*{
      background-color: black;
			margin: 0;
			padding: 0;
			list-style: none;
		}
		.wrap{
			width: 100%;
		}
		.item{
			margin:0px 10px 20px;
      width:800px;
      height:20px;
      margin:0 auto;
		}
	</style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script>function sendData() {
        google.script.run.withSuccessHandler(
          function(data){
            if (data.includes("查無資料")){
              data = data.toUpperCase();
              document.getElementById("search_result").innerHTML = data;
              document.getElementById("barcode_svg").innerHTML = "";

              this.cleanResult();              
              this.clean();
            }else{              
              try{
                JsBarcode("#barcode_svg", data[3] + "0019999999", {width:4, fontSize:30});}
              catch (e){
                console.log(e)
                document.getElementById("barcode_svg").innerHTML = "";
                this.clean();
                this.cleanResult();
                this.cleanSearchResult();
              }
              document.getElementById("product_code_title").innerHTML = "1、藥材編號：";
              document.getElementById("drug_code_title").innerHTML = "2、料位號：";
              document.getElementById("drug_name_title").innerHTML = "3、藥品名稱：";
              document.getElementById("first_brand_name_title").innerHTML = "4、第一商品名：";
              document.getElementById("secend_brand_name_title").innerHTML = "5、第二商品名：";
              document.getElementById("pb_location_title").innerHTML = "6、PB定位：";
              document.getElementById("pp_location_title").innerHTML = "7、PP定位：";
              document.getElementById("pa_location_title").innerHTML = "8、PA定位：";
              document.getElementById("mye_location_title").innerHTML = "9、MYE定位：";
              document.getElementById("pk_location_title").innerHTML = "10、PK定位：";

              document.getElementById("product_code").innerHTML = data[0];
              document.getElementById("drug_code").innerHTML = data[3];
              document.getElementById("drug_name").innerHTML = data[1];
              document.getElementById("first_brand_name").innerHTML = data[2];
              document.getElementById("secend_brand_name").innerHTML = data[4];
              document.getElementById("pb_location").innerHTML = data[5];
              document.getElementById("pp_location").innerHTML = data[6];
              document.getElementById("pa_location").innerHTML = data[7];
              document.getElementById("mye_location").innerHTML = data[8];
              document.getElementById("pk_location").innerHTML = data[9];
              
              this.cleanSearchResult();
              this.clean();              
            }
          }
        ).searchSheet(document.getElementById("input_user").value.trim());
      };      
    </script>

  <script>function sendProductCode() {
        google.script.run.withSuccessHandler(
          function(data){
            if (data.includes("查無資料")){
              data = data.toUpperCase();
              document.getElementById("search_result").innerHTML = data;
              document.getElementById("barcode_svg").innerHTML = "";

              this.cleanResult();              
              this.clean();
            }else{              
              try{
                JsBarcode("#barcode_svg", data[3] + "0019999999", {width:4, fontSize:30});}
              catch (e){
                console.log(e)
                document.getElementById("barcode_svg").innerHTML = "";
                this.clean();
                this.cleanResult();
                this.cleanSearchResult();
              }
              document.getElementById("product_code_title").innerHTML = "1、藥材編號：";
              document.getElementById("drug_code_title").innerHTML = "2、料位號：";
              document.getElementById("drug_name_title").innerHTML = "3、藥品名稱：";
              document.getElementById("first_brand_name_title").innerHTML = "4、第一商品名：";
              document.getElementById("secend_brand_name_title").innerHTML = "5、第二商品名：";
              document.getElementById("pb_location_title").innerHTML = "6、PB定位：";
              document.getElementById("pp_location_title").innerHTML = "7、PP定位：";
              document.getElementById("pa_location_title").innerHTML = "8、PA定位：";
              document.getElementById("mye_location_title").innerHTML = "9、MYE定位：";
              document.getElementById("pk_location_title").innerHTML = "10、PK定位：";

              document.getElementById("product_code").innerHTML = data[0];
              document.getElementById("drug_code").innerHTML = data[3];
              document.getElementById("drug_name").innerHTML = data[1];
              document.getElementById("first_brand_name").innerHTML = data[2];
              document.getElementById("secend_brand_name").innerHTML = data[4];
              document.getElementById("pb_location").innerHTML = data[5];
              document.getElementById("pp_location").innerHTML = data[6];
              document.getElementById("pa_location").innerHTML = data[7];
              document.getElementById("mye_location").innerHTML = data[8];
              document.getElementById("pk_location").innerHTML = data[9];
              
              this.cleanSearchResult();
              this.clean();              
            }
          }
        ).searchProductCode(document.getElementById("input_user").value.trim());
      };      
    </script>
  
  <script>function barcodeGenerate(){
        strBarcode = document.getElementById("input_user").value.trim();
      if (strBarcode.length < 1){
        document.getElementById("search_result").innerHTML = "請輸入資訊。";
        document.getElementById("barcode_svg").innerHTML = "";

        this.cleanResult();
        this.clean();
      }else{
        JsBarcode("#barcode_svg", strBarcode.toUpperCase() + "0019999999", {width:4, fontSize:30});

        this.cleanSearchResult();
        this.cleanResult();
        this.clean();        
      }        
  };
    </script>

    <script>function clean() {
        document.getElementById("input_user").value = "";
      };      
    </script>

    <script>function cleanResult() {
        document.getElementById("product_code_title").innerHTML = "";
        document.getElementById("drug_code_title").innerHTML = "";
        document.getElementById("drug_name_title").innerHTML = "";
        document.getElementById("first_brand_name_title").innerHTML = "";
        document.getElementById("secend_brand_name_title").innerHTML = "";
        document.getElementById("pb_location_title").innerHTML = "";
        document.getElementById("pp_location_title").innerHTML = "";
        document.getElementById("pa_location_title").innerHTML = "";
        document.getElementById("mye_location_title").innerHTML = "";
        document.getElementById("pk_location_title").innerHTML = "";

        document.getElementById("product_code").innerHTML = "";
        document.getElementById("drug_code").innerHTML = "";
        document.getElementById("drug_name").innerHTML = "";
        document.getElementById("first_brand_name").innerHTML = "";
        document.getElementById("secend_brand_name").innerHTML = "";
        document.getElementById("pb_location").innerHTML = "";
        document.getElementById("pp_location").innerHTML = "";
        document.getElementById("pa_location").innerHTML = "";
        document.getElementById("mye_location").innerHTML = "";
        document.getElementById("pk_location").innerHTML = "";
    };
    </script>

    <script>function cleanSearchResult() {
        document.getElementById("search_result").innerHTML = "";
      };      
    </script>

    <script>function updateTime() {
        google.script.run.withSuccessHandler(
          function(data){            
              document.getElementById("drugfile_update_date_id").innerHTML = data[1];
              document.getElementById("pb_locationfile_update_date_id").innerHTML = data[2];
              document.getElementById("pp_locationfile_update_date_id").innerHTML = data[3];
              document.getElementById("pa_locationfile_update_date_id").innerHTML = data[4];
              document.getElementById("mye_locationfile_update_date_id").innerHTML = data[5];
              document.getElementById("pk_locationfile_update_date_id").innerHTML = data[6];
              document.getElementById("version_id").innerHTML = data[7];

          }
        ).searchUpdateTime();
      };      
    </script>

  </head>
  <body onload="updateTime()">
    <div class="wrap">
	<div class="item">
        <br>
		<h1 style="font-size: 50px;">品項名查詢</h1>
      <br>
        <input id="input_user" type="text" style="font-size: 150px; width: 1200px; background-color: white" name="userName">
      <br><br><br>
      <button type="submit" onclick="sendData()">用料位號查詢</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <br><br><br>
      <button type="submit" onclick="sendProductCode()">用材編查詢</button>
      <br><br><br>
      <button type="submit" onclick="barcodeGenerate()">產生Barcode</button>       
      <br><br><br>
      <button type="reset" onclick="clean()">清除</button>
      <br><br><br>
    
    <svg id="barcode_svg"></svg>
    <h1 id="search_result" style="font-size: 4em; color: #FFA600;"></h1>

    <h1 id="product_code_title"></h1><h1 id="product_code" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="drug_code_title"></h1><h1 id="drug_code" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="drug_name_title"></h1><h1 id="drug_name" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="first_brand_name_title"></h1><h1 id="first_brand_name" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="secend_brand_name_title"></h1><h1 id="secend_brand_name" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="pb_location_title"></h1><h1 id="pb_location" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="pp_location_title"></h1><h1 id="pp_location" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="pa_location_title"></h1><h1 id="pa_location" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="mye_location_title"></h1><h1 id="mye_location" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <h1 id="pk_location_title"></h1><h1 id="pk_location" style="font-size: 4em; color: #FFA600;"></h1><br><br>
    <br><br><br>
    <h4 id="drugfile_update_date_id" style="font-size: 2em; color: #FFA600;"></h4>
    <h4 id="pb_locationfile_update_date_id" style="font-size: 2em; color: #FFA600;"></h4>
    <h4 id="pp_locationfile_update_date_id" style="font-size: 2em; color: #FFA600;"></h4>
    <h4 id="pa_locationfile_update_date_id" style="font-size: 2em; color: #FFA600;"></h4>
    <h4 id="mye_locationfile_update_date_id" style="font-size: 2em; color: #FFA600;"></h4>
    <h4 id="pk_locationfile_update_date_id" style="font-size: 2em; color: #FFA600;"></h4><br>
    <h4 id="version_id" style="color: #FFA600;"><h4>
    <h4 style="color: #FFA600;">作者：Vincent 燊<h4>
	</div>  
</div>
  </body>
</html>
